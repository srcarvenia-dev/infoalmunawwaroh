<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Masjid Al Munawwaroh - Official Landing Page</title>
    
    <meta name="description" content="Website Resmi Masjid Al Munawwaroh Desa Cipancuh, Haurgeulis, Indramayu.">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&family=Amiri:wght@700&display=swap" rel="stylesheet">

    <meta name="theme-color" content="#064e3b">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <link rel="manifest" href='data:application/json,{"name":"Masjid Al Munawwaroh","short_name":"AlMunawwaroh","start_url":"/","display":"standalone","background_color":"#064e3b","theme_color":"#064e3b","icons":[{"src":"https://cdn-icons-png.flaticon.com/512/2665/2665119.png","sizes":"512x512","type":"image/png","purpose":"any maskable"}]}'>

    <style>
        :root {
            --primary: #064e3b; 
            --secondary: #10b981;
            --accent: #d4af37;
            --bg-body: #f8fafc;
            --hero-img: url('https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgdIXqMB33ZDZf-EkafxYOgJUm-X9wMb8ecOi1RD95DzY3SdxnPUpdtHqCO5avwDJu6bAjNqGvb4_Jk-wZDifOOqG0PYnYPxufQ5mtayINaH557Pyard32eFvCelZneZQU8F7Lp13J4De4dtO-LtvoGG5sznhpWY1SM6FZKsA8SZOY5v68OGJN2a59-pJi2/s1600/487230d5-4ac3-455f-9a87-478498d5ef6e%281%29.jpg');
        }

        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: var(--bg-body); color: #334155; scroll-behavior: smooth; overflow-x: hidden; }
        
        /* Pembersihan elemen bawaan Blogger */
        #header-wrapper, .navbar-blogger, .quickedit, .widget-item-control, .navbar { display: none !important; }

        .ticker-wrap { background: var(--primary); color: white; padding: 12px 0; font-size: 0.85rem; border-bottom: 2px solid var(--accent); overflow: hidden; position: sticky; top: 0; z-index: 1000; }
        .ticker-move { display: inline-block; white-space: nowrap; animation: ticker 40s linear infinite; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        .hero-section { 
            height: 80vh; min-height: 550px;
            background: linear-gradient(rgba(6, 78, 59, 0.7), rgba(6, 78, 59, 0.8)), var(--hero-img); 
            background-size: cover; background-position: center; background-attachment: fixed;
            display: flex; align-items: center; color: white; border-radius: 0 0 60px 60px; margin-bottom: -60px;
        }

        /* Navigasi Utama (Card Menu) */
        .menu-container { position: relative; z-index: 10; }
        .menu-tile { 
            background: white; border-radius: 20px; padding: 25px 10px; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.1); text-align: center; 
            border-bottom: 5px solid var(--accent); transition: all 0.3s ease;
            text-decoration: none; display: block; height: 100%;
        }
        .menu-tile:hover { transform: translateY(-12px); background: var(--primary); border-bottom: 5px solid var(--secondary); }
        .menu-tile i { font-size: 2.2rem; color: var(--accent); margin-bottom: 12px; transition: 0.3s; }
        .menu-tile span { display: block; font-weight: 800; color: var(--primary); font-size: 0.85rem; text-transform: uppercase; transition: 0.3s; }
        .menu-tile:hover i, .menu-tile:hover span { color: white; }

        section { padding: 90px 0; }
        .section-title { font-weight: 800; color: var(--primary); font-size: 2.5rem; margin-bottom: 1rem; text-align: center; }
        
        .kas-card, .jumat-card, .agenda-card { border: none; border-radius: 24px; padding: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.03); background: white; transition: 0.3s; height: 100%; border: 1px solid rgba(0,0,0,0.05); }
        .agenda-card { border-left: 6px solid var(--accent); }
        
        .ayat-box { background: white; border-radius: 35px; padding: 50px; box-shadow: 0 20px 50px rgba(0,0,0,0.05); border-left: 12px solid var(--accent); position: relative; }
        .arabic-text { font-family: 'Amiri', serif; font-size: 2.4rem; line-height: 2.2; color: var(--primary); direction: rtl; }

        .btn-primary-custom { background: var(--accent); color: white !important; border-radius: 50px; padding: 15px 40px; font-weight: 700; border: none; text-decoration: none; display: inline-block; transition: 0.3s; cursor: pointer; }
        .btn-primary-custom:hover { background: var(--primary); transform: scale(1.05); }
        
        .wa-float { position: fixed; bottom: 30px; right: 30px; background: #25d366; color: white; width: 65px; height: 65px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; z-index: 1000; box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4); }
        
        .spinner { width: 40px; height: 40px; border: 4px solid rgba(212, 175, 55, 0.1); border-left-color: var(--accent); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-overlay { display: flex; justify-content: center; padding: 40px; width: 100%; }

        @media (max-width: 768px) {
            .hero-section { height: 75vh; border-radius: 0 0 40px 40px; }
            .section-title { font-size: 1.8rem; }
            .menu-tile { padding: 15px 5px; }
            .menu-tile i { font-size: 1.6rem; }
            .menu-tile span { font-size: 0.65rem; }
        }
    </style>
</head>
<body>

<div class="ticker-wrap" id="beranda">
    <div class="ticker-move">
        ðŸ“Œ INFO: Salurkan Infaq Terbaik anda ke Rek BRI 4189-0103-7180-530 a.n DKM Al Munawwaroh â€¢ Mari makmurkan masjid dengan Sholat Berjamaah tepat waktu.
    </div>
</div>

<header class="hero-section">
    <div class="container text-center">
        <div class="badge bg-white text-success px-3 py-2 rounded-pill mb-3 fw-bold shadow-sm" style="color: var(--primary) !important;">RESMI - CIPANCUH</div>
        <h1 class="display-3 fw-extrabold mb-3 text-white">Masjid Al Munawwaroh</h1>
        <p class="lead mb-5 text-white opacity-90 mx-auto" style="max-width: 700px;">Pusat Ibadah, Pendidikan, dan Pemberdayaan Ummat di Indramayu.</p>
        <div class="d-flex justify-content-center flex-wrap gap-3">
            <a class="btn btn-primary-custom shadow-lg" href="#sedekah">Infaq Sekarang</a>
            <button id="btnInstall" class="btn btn-outline-light rounded-pill px-4 fw-bold" style="display:none;" onclick="installApp()">
                <i class="fas fa-download me-2"></i>Pasang Aplikasi
            </button>
            <a class="btn btn-outline-light rounded-pill px-4 fw-bold" href="#profil">Profil</a>
        </div>
    </div>
</header>

<div class="container menu-container">
    <div class="row g-2 g-md-3 justify-content-center">
        <div class="col-4 col-md-2"><a href="#profil" class="menu-tile"><i class="fas fa-mosque"></i><span>Profil</span></a></div>
        <div class="col-4 col-md-2"><a href="#agenda" class="menu-tile"><i class="fas fa-calendar-alt"></i><span>Agenda</span></a></div>
        <div class="col-4 col-md-2"><a href="#jumat" class="menu-tile"><i class="fas fa-microphone-alt"></i><span>Jumat</span></a></div>
        <div class="col-4 col-md-2"><a href="#warta" class="menu-tile"><i class="fas fa-bullhorn"></i><span>Warta</span></a></div>
        <div class="col-4 col-md-2"><a href="#keuangan" class="menu-tile"><i class="fas fa-wallet"></i><span>Laporan</span></a></div>
        <div class="col-4 col-md-2"><a href="#sedekah" class="menu-tile"><i class="fas fa-heart"></i><span>Infaq</span></a></div>
    </div>
</div>

<section id="profil">
    <div class="container">
        <div class="row align-items-center g-5">
            <div class="col-lg-6 order-2 order-lg-1">
                <h5 class="fw-bold text-uppercase mb-2" style="color: var(--accent);">Ahlan wa Sahlan</h5>
                <h2 class="section-title text-lg-start mb-4">Sambutan DKM</h2>
                <p class="lead text-muted mb-5">Selamat datang di portal resmi Masjid Al Munawwaroh. Kami berkomitmen menjadikan masjid sebagai pusat peradaban dan sosial bagi masyarakat Cipancuh.</p>
                <div class="border-start border-4 border-success ps-4 py-1">
                    <h5 class="fw-bold mb-0">Pengurus DKM</h5>
                    <p class="text-muted mb-0">Masjid Al Munawwaroh Cipancuh</p>
                </div>
            </div>
            <div class="col-lg-6 text-center order-1 order-lg-2">
                <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjoanIt1fhCjJL6nSso1K_0p7uBJJlYfzv2wJe543T21sq6P1mdlMgiyqqUpx5zPGIEpkpm1dvPrOAZAGRACmo5TMMWfkSS-I233eTcs7s09BPc05FE16Fdi8OdWCtlTZ-oKmYnRgO5SlmLxvTmk_Mmnqjfae6SC6KgyzR3YPDX6ctsFk79smFM4j4nSy7X/s1600/ddddddddd.jpg" class="img-fluid rounded-5 shadow-lg border border-5 border-white" alt="DKM">
            </div>
        </div>
    </div>
</section>

<section class="container py-0"><div class="ayat-box text-center"><div id="ar-text" class="arabic-text mb-4">Memuat Ayat...</div><div id="id-text" class="fst-italic mb-3 text-muted"></div><div id="ar-ref" class="fw-bold text-success"></div></div></section>

<section class="bg-light" id="agenda"><div class="container"><h2 class="section-title">Agenda Masjid</h2><div class="row g-4" id="agenda-container"></div></div></section>

<section id="jumat"><div class="container"><h2 class="section-title">Petugas Sholat Jumat</h2><div class="row g-4 justify-content-center" id="jumat-cards"></div></div></section>

<section class="bg-white" id="keuangan">
    <div class="container">
        <h2 class="section-title">Laporan Kas</h2>
        <div class="row g-4 mb-5">
            <div class="col-md-4"><div class="kas-card text-center"><h6 class="text-muted small">TOTAL MASUK</h6><h3 class="fw-bold text-success" id="summary-masuk">Rp 0</h3></div></div>
            <div class="col-md-4"><div class="kas-card text-center"><h6 class="text-muted small">TOTAL KELUAR</h6><h3 class="fw-bold text-danger" id="summary-keluar">Rp 0</h3></div></div>
            <div class="col-md-4"><div class="kas-card text-white text-center" style="background: var(--primary);"><h6>SALDO AKHIR</h6><h3 class="fw-bold" id="summary-saldo">Rp 0</h3></div></div>
        </div>
        <div class="text-center"><button class="btn btn-outline-success rounded-pill px-5 py-3 fw-bold" data-bs-target="#listKas" data-bs-toggle="collapse">Lihat Detail Laporan</button></div>
        <div class="collapse mt-4" id="listKas"><div class="table-responsive bg-white rounded-4 shadow-sm p-4"><table class="table table-hover"><thead class="table-dark"><tr><th>Tgl</th><th>Keterangan</th><th class="text-end">Masuk</th><th class="text-end">Keluar</th></tr></thead><tbody id="kas-data"></tbody></table></div></div>
    </div>
</section>

<section id="sedekah">
    <div class="container">
        <div class="ayat-box p-5 border-0 shadow-lg bg-white text-center text-md-start">
            <div class="row align-items-center">
                <div class="col-md-7">
                    <h2 class="fw-bold text-success mb-3">Infaq & Sedekah</h2>
                    <div class="bg-light p-4 rounded-4 border-start border-warning border-5 mb-4">
                        <small class="text-muted fw-bold">BANK BRI</small>
                        <h2 class="fw-bold text-dark mt-2" id="norek">4189-0103-7180-530</h2>
                        <div class="text-success fw-bold">a.n DKM AL MUNAWWAROH</div>
                    </div>
                    <button class="btn btn-primary-custom w-100 py-3" onclick="copyNorek()">Salin Nomor Rekening</button>
                </div>
                <div class="col-md-5 text-center mt-5 mt-md-0">
                    <img class="img-fluid rounded-4 shadow" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjG6V4Zaqpeon443FljDN_yd4qeunPrE51q2urRvtCBsC_Gk_nSgQ7SMxY7KY802cNkIV06SkgwU7d44tt4ybO0VzlipmarqNX70fF1S1ytGxaWF0AAu3O4GT9GhFsTJvrRVwSVsCsHOXJVgRIWIRbmToMG0Uj2hfNycEpkELRngirac2xvVV7gNsl9MQLj/s320/IMG-20251228-WA0078.jpg" alt="QRIS" style="max-height: 280px;">
                </div>
            </div>
        </div>
    </div>
</section>

<footer class="bg-dark text-white py-5 mt-5 text-center">
    <h5 class="fw-bold mb-3" style="color: var(--accent);">MASJID AL MUNAWWAROH</h5>
    <p class="small opacity-75">Desa Cipancuh, Kec. Haurgeulis, Kab. Indramayu</p>
</footer>

<a class="wa-float" href="https://wa.me/6282120465585" target="_blank"><i class="fab fa-whatsapp"></i></a>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // URL Sumber Data (Google Sheets)
    const csvKas = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQGTA_DyxcDC3JFbw2w_rjIrR2zOecNTOTGt0RJOyKjzI1DsoLDNZ4t4LaHrHLIp6yLzZN5Q-Hyy2A8/pub?gid=1247197738&single=true&output=csv';
    const csvJumat = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQGTA_DyxcDC3JFbw2w_rjIrR2zOecNTOTGt0RJOyKjzI1DsoLDNZ4t4LaHrHLIp6yLzZN5Q-Hyy2A8/pub?gid=2145598285&single=true&output=csv';
    const csvAgenda = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQGTA_DyxcDC3JFbw2w_rjIrR2zOecNTOTGt0RJOyKjzI1DsoLDNZ4t4LaHrHLIp6yLzZN5Q-Hyy2A8/pub?gid=2084790368&single=true&output=csv';

    async function init() {
        // Tampilkan loading spinner
        const loading = '<div class="loading-overlay"><div class="spinner"></div></div>';
        document.getElementById('agenda-container').innerHTML = loading;
        document.getElementById('jumat-cards').innerHTML = loading;

        // Fetch Ayat Al-Quran (Acak)
        try {
            const rdm = Math.floor(Math.random() * 6236) + 1;
            const r = await fetch(`https://api.alquran.cloud/v1/ayah/${rdm}/editions/quran-uthmani,id.indonesian`);
            const d = await r.json();
            document.getElementById('ar-text').innerText = d.data[0].text;
            document.getElementById('id-text').innerText = d.data[1].text;
            document.getElementById('ar-ref').innerText = `â€” QS. ${d.data[0].surah.englishName}: ${d.data[0].numberInSurah}`;
        } catch(e){}

        // Fetch Agenda
        try {
            const res = await fetch(csvAgenda);
            const text = await res.text();
            const rows = text.split(/\r?\n/).map(r => r.split(",")).filter(r => r.length > 1);
            let h = '';
            rows.slice(1).forEach(r => { h += `<div class="col-md-4"><div class="agenda-card"><div class="text-success small fw-bold mb-1"><i class="far fa-calendar-alt me-1"></i> ${r[0]}</div><h5 class="fw-bold mb-2">${r[1]}</h5><div class="small text-muted">${r[2] || '-'}</div></div></div>`; });
            document.getElementById('agenda-container').innerHTML = h || 'Belum ada agenda.';
        } catch(e){}

        // Fetch Petugas Jumat
        try {
            const res = await fetch(csvJumat);
            const text = await res.text();
            const rows = text.split(/\r?\n/).map(r => r.split(",")).filter(r => r.length > 1);
            let h = '';
            rows.slice(1, 4).forEach(r => { h += `<div class="col-md-4"><div class="jumat-card border-top border-warning border-4 text-center"><span class="badge bg-success mb-2">${r[0]}</span><h4 class="fw-bold mb-3">${r[1]}</h4><div class="mb-2"><b>Khotib:</b><br>${r[2]}</div><div class="small text-muted"><b>Muadzin:</b><br>${r[3]}</div></div></div>`; });
            document.getElementById('jumat-cards').innerHTML = h || 'Jadwal belum tersedia.';
        } catch(e){}

        // Fetch Laporan Kas
        try {
            const res = await fetch(csvKas);
            const text = await res.text();
            const rows = text.split(/\r?\n/).filter(r => r.trim() !== "").slice(1);
            let h = ''; let tM = 0; let tK = 0;
            rows.forEach(row => {
                const c = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                if(c.length >= 5) {
                    const m = parseInt(c[3].replace(/[^0-9]/g, "")) || 0;
                    const k = parseInt(c[4].replace(/[^0-9]/g, "")) || 0;
                    tM += m; tK += k;
                    h += `<tr><td>${c[0]}</td><td>${c[1]}</td><td class="text-end text-success">Rp ${m.toLocaleString('id-ID')}</td><td class="text-end text-danger">Rp ${k.toLocaleString('id-ID')}</td></tr>`;
                }
            });
            document.getElementById('kas-data').innerHTML = h;
            document.getElementById('summary-masuk').innerText = 'Rp ' + tM.toLocaleString('id-ID');
            document.getElementById('summary-keluar').innerText = 'Rp ' + tK.toLocaleString('id-ID');
            document.getElementById('summary-saldo').innerText = 'Rp ' + (tM - tK).toLocaleString('id-ID');
        } catch(e){}
    }

    function copyNorek() {
        const nr = document.getElementById('norek').innerText;
        navigator.clipboard.writeText(nr).then(() => { alert("Nomor Rekening Berhasil Disalin!"); });
    }

    // --- LOGIKA PWA & INSTALL ---
    let deferredPrompt;
    const btnInstall = document.getElementById('btnInstall');

    // Mendaftarkan Service Worker (Syarat PWA)
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            const swCode = `self.addEventListener('install', e => self.skipWaiting()); self.addEventListener('fetch', e => e.respondWith(fetch(e.request)));`;
            const blob = new Blob([swCode], { type: 'text/javascript' });
            navigator.serviceWorker.register(URL.createObjectURL(blob)).catch(err => console.log('SW failed', err));
        });
    }

    // Menangkap event "siap install" dari Chrome
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        // Tampilkan tombol install manual
        btnInstall.style.display = 'inline-block';
    });

    // Fungsi saat tombol install diklik
    async function installApp() {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            if (outcome === 'accepted') {
                btnInstall.style.display = 'none';
            }
            deferredPrompt = null;
        }
    }

    window.onload = init;
</script>
</body>
</html>
